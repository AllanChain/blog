---
import { prefixLink } from '@/utils'
import IconedLink from '@components/IconedLink.astro'
import { profileUrl } from '@data/config'

export interface Props {
  title?: string
}

const { title } = Astro.props as Props
---

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{title}</title>
    <link rel="icon" type="image/x-icon" href={prefixLink('favicon.ico')} />
    <link rel="sitemap" href={prefixLink('sitemap-index.xml')} />
    <slot name="head" />
    <meta name="generator" content="astro" />
    <script>
      // Replace server-rendered date title to those with client's locale
      for (const el of document.querySelectorAll<HTMLDivElement>('[data-date]')) {
        el.title = new Date(el.dataset.date).toLocaleString(undefined, {
          timeZone: 'Asia/Shanghai',
        })
      }
    </script>
  </head>
  <body class="px-4 bg-gray-100 dark:bg-gray-900 dark:text-gray-200">
    <nav flex flex-wrap items-center justify-end py-2>
      <a
        href={prefixLink('')}
        flex
        items-center
        text-current
        decoration-none
        cursor-pointer
      >
        <img
          src={prefixLink('avatar/37.png')}
          alt="avatar"
          width="37"
          height="37"
          rounded-full
          overflow-hidden
        />
        <div mx-2 font-bold text-lg text-sky-900 dark:text-sky-500>AC Dustbin</div>
      </a>
      <div flex-1></div>
      <div>
        <IconedLink
          icon="i-mdi-book-open-variant"
          name="Posts"
          url={prefixLink('posts/')}
        />
        <IconedLink
          icon="i-mdi-label-multiple-outline"
          name="Labels"
          url={prefixLink('labels/')}
        />
        <IconedLink
          icon="i-mdi-information-outline"
          name="About"
          url={prefixLink('post/about/')}
        />
        <IconedLink icon="i-mdi-github" name="Me" url={profileUrl} />
      </div>
    </nav>
    <div border="0 b-2 dotted gray-500" m="b-4 x--4"></div>
    <slot />
    <footer text="center sm" m="y-4 x--4" border="0 t-2 dotted gray-300 dark:gray-700">
      <p my-1>
        <i i-mdi-creative-commons></i>
        <a
          href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
          title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License"
          theme-link
        >
          BY-NC-SA
        </a>
         for the
        <a href="https://github.com/AllanChain/blog/issues" theme-link>posts</a>.
        <i i-mdi-license></i>
        <a href="https://github.com/AllanChain/blog/blob/astro/LICENSE" theme-link>
          MIT
        </a>
         for the
        <a href="https://github.com/AllanChain/blog" theme-link>code</a>.
      </p>
      <p my-1 mx-1 inline-block>
        Made by <a href="https://github.com/AllanChain" theme-link>Allan Chain</a>.
        Coded with <a href="https://astro.build/" theme-link>Astro</a>.
      </p>
      <p my-1 inline-block>
        Powered by <a href="https://github.com/" theme-link>GitHub</a>. Presented to
        you.
      </p>
    </footer>
    <style is:global>
      @media (prefers-color-scheme: dark) {
        div[alt*='in light theme'],
        img[alt*='in light theme'] {
          filter: brightness(0.8) contrast(1.2);
        }
      }
      html {
        font-family:
          -apple-system,
          BlinkMacSystemFont,
          PingFang SC,
          Hiragino Sans GB,
          Microsoft Yahei,
          Arial,
          sans-serif;
      }
    </style>
    <script async data-id="101404732" src="//static.getclicky.com/js"></script>
  </body>
</html>
